{"version":3,"sources":["node_modules/browser-pack/_prelude.js","build/js/my/Utils.js","build/js/my/app.js"],"names":[],"mappings":"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","file":"app.min.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","export const clip = (n, m, M) => (\r\n  n < M ? n > m ? n : m : M\r\n);\r\n\r\nexport const comeCloser = (n, goal, factor, limit) => (\r\n  (limit && Math.abs(goal - n) < limit) ? goal : n + (goal - n) / (factor || 10)\r\n);\r\n\r\nexport const dist = (a, b) => {\r\n  const dx = b[0] - a[0],\r\n  dy = b[1] - a[1],\r\n  dz = b[2] - a[2];\r\n  return Math.sqrt(dx * dx + dy * dy + dz * dz);\r\n}\r\n\r\nexport const normalize = (v) => {\r\n  const l = Math.sqrt(v[0]*v[0]+v[1]*v[1]+v[2]*v[2]);\r\n  return [v[0] / l, v[1] / l, v[2] / l];\r\n}\r\n\r\nexport const projection = (p, d, s) => {\r\n  const f = (s || 1) / (1 - p[2] / d);\r\n  return [p[0]*f, p[1]*f, p[2]];\r\n}\r\n\r\nexport const rotateX = (p, a) => {\r\n  const d = Math.sqrt(p[2] * p[2] + p[1] * p[1]),\r\n    na = Math.atan2(p[2], p[1]) + a;\r\n  return [p[0], d * Math.cos(na), d * Math.sin(na)];\r\n}\r\n\r\nexport const rotateY = (p, a) => {\r\n  const d = Math.sqrt(p[2] * p[2] + p[0] * p[0]),\r\n    na = Math.atan2(p[0], p[2]) + a;\r\n  return [d * Math.sin(na), p[1], d * Math.cos(na)];\r\n}\r\n\r\nexport const rotateZ = (p, a) => {\r\n  const d = Math.sqrt(p[1] * p[1] + p[0] * p[0]),\r\n    na = Math.atan2(p[1], p[0]) + a;\r\n  return [d * Math.cos(na), d * Math.sin(na), p[2]];\r\n}\r\n\r\nexport const rotateMatrix = (p, m) => ([\r\n  p[0] * m[0] + p[1] * m[3] + p[2] * m[6],\r\n  p[0] * m[1] + p[1] * m[4] + p[2] * m[7],\r\n  p[0] * m[2] + p[1] * m[5] + p[2] * m[8]\r\n]);\r\n\r\nexport const rotate3dMatrix = (x, y, z, a) => {\r\n  const c = 1 - Math.cos(a),\r\n    s = Math.sin(a);\r\n\r\n  return [\r\n    1+c*(x*x-1), x*y*c+z*s, x*z*c-y*s,\r\n    x*y*c-z*s, 1+c*(y*y-1), y*z*c+x*s,\r\n    x*z*c+y*s, y*z*c-x*s, 1+c*(z*z-1)\r\n  ];\r\n}\r\n\r\nconst mul33 = (m, n) => {\r\n  const m1 = m[0], m2 = m[1], m3 = m[2],\r\n    m4 = m[3], m5 = m[4], m6 = m[5],\r\n    m7 = m[6], m8 = m[7], m9 = m[8];\r\n  \r\n  const n1 = n[0], n2 = n[1], n3 = n[2],\r\n    n4 = n[3], n5 = n[4], n6 = n[5],\r\n    n7 = n[6], n8 = n[7], n9 = n[8];\r\n  \r\n  return [\r\n    m1*n1+m4*n2+m7*n3, m2*n1+m5*n2+m8*n3, m3*n1+m6*n2+m9*n3,\r\n    m1*n4+m4*n5+m7*n6, m2*n4+m5*n5+m8*n6, m3*n4+m6*n5+m9*n6,\r\n    m1*n7+m4*n8+m7*n9, m2*n7+m5*n8+m8*n9, m3*n7+m6*n8+m9*n9\r\n  ];\r\n}\r\n\r\nexport function chainMul33(base) {\r\n  for(var i = 1, l = arguments.length; i < l; i++)\r\n    base = mul33(base, arguments[i]);\r\n  return base;\r\n}\r\n","import {\r\n  clip,\r\n  projection,\r\n  rotateX,\r\n  rotateY,\r\n  rotateZ,\r\n  rotateMatrix,\r\n  rotate3dMatrix,\r\n  chainMul33,\r\n} from './Utils';\r\n\r\nconst c = document.getElementById('draw'), ctx = c.getContext('2d');\r\n\r\nfunction onResize() {\r\n  c.width = c.clientWidth;\r\n  c.height = c.clientHeight;\r\n}\r\n\r\nwindow.addEventListener('resize', onResize);\r\n\r\nonResize();\r\n\r\nconst drawCubes = (function() {\r\n  const v = [\r\n  [-1,-1,-1],\r\n  [-1,-1, 1],\r\n  [ 1,-1, 1],\r\n  [ 1,-1,-1],\r\n  [ 1, 1,-1],\r\n  [-1, 1,-1],\r\n  [-1, 1, 1],\r\n  [ 1, 1, 1],\r\n  ], e = [];\r\n  const eFull = '0-1 1-2 2-3 3-0 4-5 5-6 6-7 7-4 0-5 1-6 2-7 3-4'.split(' ');\r\n\r\n  for(let i = eFull.length, ea; i--;) e.push([+(ea=eFull[i].split('-'))[0], +ea[1]]);\r\n    const offset = Math.PI * .25, s1 = .5 / Math.sqrt(3), s2 = s1 / Math.sqrt(3), s3 = s2 / Math.sqrt(3);\r\n  const draws = [{\r\n    color: '#2ecc71',\r\n    transform: (p, m) => projection(rotateX(rotateMatrix(p, m), offset), perspective, cubeSize * s1),\r\n  }, {\r\n    color: '#e74c3c',\r\n    transform: (p, m) => projection(rotateY(rotateMatrix(p, m), offset), perspective, cubeSize * s2),\r\n  }, {\r\n    color: '#f1c40f',\r\n    transform: (p, m) => projection(rotateZ(rotateMatrix(p, m), offset), perspective, cubeSize * s3)\r\n  }];\r\n\r\n  return (ctx) => {\r\n    let allLines = [], i, l, d;\r\n    for(d = draws.length; d--;) {\r\n      const draw = draws[d];\r\n      let points = [];\r\n\r\n      for(i = 0, l = v.length; i < l; i++)\r\n        points.push(draw.transform(v[i], rotMatrix));\r\n\r\n      for(i = e.length; i--;) {\r\n        let edge = e[i], p1 = points[edge[0]], p2 = points[edge[1]];\r\n        let z = (p1[2] + p2[2]) * .5;\r\n        allLines.push([p1[0], p1[1], p2[0], p2[1], z, draw.color]);\r\n      }\r\n    }\r\n\r\n    allLines.sort(function(a, b) { return b[4] - a[4]; });\r\n    ctx.lineWidth = 1.2;\r\n\r\n    for(i = allLines.length; i--;) {\r\n      l = allLines[i];\r\n      ctx.strokeStyle = l[5];\r\n      ctx.beginPath();\r\n      ctx.moveTo(l[0], l[1]);\r\n      ctx.lineTo(l[2], l[3]);\r\n      ctx.stroke();\r\n    }\r\n  };\r\n})();\r\n\r\nconst drawGrowing = (function() {\r\n  const easing = t => t < 0.5 ? 2 * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\r\n\r\n  let globalScale = 1, globalRot = 0, rotX = -.17;\r\n\r\n  const transformed = v => projection(rotateX(rotateY(v, globalRot), rotX), perspective);\r\n\r\n  const box = (ctx, sX, sY, sZ) => {\r\n    let p1 = transformed([-sX, -sY, sZ]),\r\n    p2 = transformed([ sX, -sY, sZ]),\r\n    p3 = transformed([ sX,  sY, sZ]),\r\n    p4 = transformed([-sX,  sY, sZ]),\r\n    p5 = transformed([-sX, -sY,-sZ]),\r\n    p6 = transformed([ sX, -sY,-sZ]),\r\n    p7 = transformed([ sX,  sY,-sZ]),\r\n    p8 = transformed([-sX,  sY,-sZ]);\r\n    ctx.moveTo(p1[0], p1[1]);\r\n    ctx.lineTo(p2[0], p2[1]);\r\n    ctx.lineTo(p3[0], p3[1]);\r\n    ctx.lineTo(p4[0], p4[1]);\r\n    ctx.lineTo(p1[0], p1[1]);\r\n    ctx.lineTo(p5[0], p5[1]);\r\n    ctx.lineTo(p6[0], p6[1]);\r\n    ctx.lineTo(p7[0], p7[1]);\r\n    ctx.lineTo(p8[0], p8[1]);\r\n    ctx.lineTo(p5[0], p5[1]);\r\n    ctx.moveTo(p2[0], p2[1]);\r\n    ctx.lineTo(p6[0], p6[1]);\r\n    ctx.moveTo(p3[0], p3[1]);\r\n    ctx.lineTo(p7[0], p7[1]);\r\n    ctx.moveTo(p4[0], p4[1]);\r\n    ctx.lineTo(p8[0], p8[1]);\r\n  }\r\n\r\n  let pT, dtMax = 1 / 60, t = 0;\r\n  const animDur = 2.1;\r\n\r\n  return (ctx) => {\r\n    const now = Date.now();\r\n    let dt = 0;\r\n    if(pT) dt = Math.min((now - pT) * .001, dtMax);\r\n    pT = now;\r\n    t += dt;\r\n    const p = (t % animDur) / animDur;\r\n    globalScale = 1 - p * .5;\r\n    globalRot = p * Math.PI / 2;\r\n    const sc = cubeSize * .2;\r\n    ctx.scale(sc, sc);\r\n    ctx.strokeStyle = '#57ff57';\r\n    ctx.lineWidth = .75 / sc;\r\n    ctx.beginPath();\r\n    box(ctx, globalScale, globalScale, globalScale);\r\n    const scx = easing(clip(p / .27, 0, 1)) * 1.5 + .5,\r\n    scy = easing(clip((p - .27) / .27, 0, 1)) * 1.5 + .5,\r\n    scz = easing(clip((p - .54) / .27, 0, 1)) * 1.5 + .5;\r\n    box(ctx, globalScale * scx, globalScale * scy, globalScale * scz);\r\n    ctx.stroke();\r\n  };\r\n})();\r\n\r\n\r\nconst baseCorners = [\r\n[-1, -1,  1], [ 1, -1,  1], [ 1, 1,  1], [-1, 1,  1],\r\n[ 1, -1, -1], [-1, -1, -1], [-1, 1, -1], [ 1, 1, -1],\r\n];\r\n\r\nconst faces = [\r\n{\r\n  name: 'front',\r\n  corners: [0,1,2,3],\r\n  draw: () => ({})\r\n}, {\r\n  name: 'back',\r\n  corners: [4,5,6,7],\r\n  draw: drawGrowing\r\n}, {\r\n  name: 'left',\r\n  corners: [5,0,3,6],\r\n  draw: () => ({})\r\n}, {\r\n  name: 'right',\r\n  corners: [1,4,7,2],\r\n  draw: () => ({})\r\n}, {\r\n  name: 'bottom',\r\n  corners: [3,2,7,6],\r\n  draw: () => ({})\r\n}, {\r\n  name: 'top',\r\n  corners: [5,4,1,0],\r\n  draw: drawCubes\r\n}];\r\n\r\n\r\nconst faceBg = 'rgba(4,13,24,.65)';\r\nconst border = 'rgb(40,130,240)';\r\nconst cubeSize = 160, perspective = 15;\r\n\r\n\r\nlet rot = [0,0,0];\r\nconst rotVel = [-6e-3,7.6e-3,2.13e-3];\r\nlet rotBase = [1,0,0,0,1,0,0,0,1];\r\nlet rotMatrix;\r\n\r\nfunction setBase() {\r\n  rotBase = rotMatrix;\r\n  rot = [0,0,0];\r\n}\r\n\r\nfunction loop() {\r\n  const mx = rotate3dMatrix(1,0,0,rot[0]);\r\n  const my = rotate3dMatrix(0,1,0,rot[1]);\r\n  const mz = rotate3dMatrix(0,0,1,rot[2]);\r\n  rotMatrix = chainMul33(mx, my, mz, rotBase);\r\n\r\n  const w = c.width; \r\n  const h = c.height;\r\n\r\n  const corners = baseCorners.map(c => {\r\n    let res = projection(rotateMatrix(c, rotMatrix), perspective, cubeSize * .5);\r\n    res[0] += w * .5; res[1] += h * .5;\r\n    return res;\r\n  });\r\n\r\n  ctx.clearRect(0, 0, w, h);\r\n  for(let i = 0, l = faces.length; i < l; i++) {\r\n    const face = faces[i];\r\n    let z = 0;\r\n    const faceCorners = face.currentCorners = face.corners.map(i => {\r\n      const c = corners[i];\r\n      z += c[2];\r\n      return c;\r\n    });\r\n    face.z = z * .25;\r\n  }\r\n\r\n  faces.sort((a, b) => a.z - b.z);\r\n\r\n  for(let i = 0, l = faces.length; i < l; i++) {\r\n    const face = faces[i];\r\n    const faceCorners = face.currentCorners;\r\n    let drawBg;\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.rect(0, 0, c.width, c.height);\r\n    drawPath(ctx, faceCorners);\r\n    ctx.clip();\r\n    ctx.beginPath();\r\n    drawPath(ctx, faceCorners);\r\n    ctx.clip();\r\n\r\n    face.draw && \r\n    ctx.save();\r\n    ctx.translate(w * .5, h * .5);\r\n    drawBg = face.draw(ctx, faces, corners);\r\n    ctx.restore();\r\n\r\n    ctx.restore();\r\n\r\n    Object.assign(ctx, {\r\n      fillStyle: faceBg,\r\n      strokeStyle: border,\r\n      lineWidth: 0.5,\r\n    });\r\n\r\n\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.rect(c.width, 0, -c.width, c.height);\r\n    drawPath(ctx, faceCorners);\r\n    ctx.clip();\r\n    ctx.beginPath();\r\n    drawPath(ctx, faceCorners);\r\n    ctx.fill();\r\n    ctx.restore();\r\n\r\n    ctx.beginPath();\r\n    drawPath(ctx, faceCorners);\r\n    if(drawBg) ctx.fill();\r\n    ctx.stroke();\r\n  }\r\n  requestAnimationFrame(loop);\r\n}\r\n\r\nrequestAnimationFrame(loop);\r\n\r\nfunction drawPath(ctx, corners) {\r\n  if(!corners.length) return;\r\n\r\n  ctx.moveTo(corners[0][0], corners[0][1]);\r\n  corners.map((item, i) => ctx.lineTo(corners[i][0], corners[i][1]));\r\n  ctx.lineTo(corners[0][0], corners[0][1]);\r\n}\r\n\r\n\r\n(function() {\r\n  let grabbed = false;\r\n  let moved = false;\r\n  let cPos;\r\n  let pPos;\r\n  let lastMoveTime, vel, timer;\r\n  const factor = 3e-3;\r\n\r\n  function getPos(e) {\r\n    if(e.touches && e.touches.length)\r\n      e = e.touches[0];\r\n    return [e.clientX,e.clientY];\r\n  }\r\n\r\n  function stopMomentum() {\r\n    cancelAnimationFrame(timer); \r\n    timer = null; \r\n  }\r\n\r\n  function mouseDown(e) {\r\n    if(grabbed) return;\r\n\r\n    if(!e.touches)\r\n      e.preventDefault();\r\n\r\n    stopMomentum();\r\n    cPos = pPos = grabbed = getPos(e);\r\n    moved = false;\r\n  }\r\n\r\n  function mouseMove(e) {\r\n    if(!grabbed) return;\r\n\r\n    const pos = getPos(e);\r\n    const dx = grabbed[1] - pos[1], dy = pos[0] - grabbed[0];\r\n\r\n    if(!moved) {\r\n      if(dx * dx + dy * dy < 16) return;\r\n      moved = true;\r\n      setBase();\r\n    }\r\n\r\n    lastMoveTime = Date.now();\r\n    pPos = cPos; cPos = pos;\r\n    rot = [dx * factor, dy * factor, 0];\r\n  }\r\n\r\n  function mouseUp(e) {\r\n    if(!grabbed) return;\r\n    grabbed = false;\r\n    if(!moved) return;\r\n    const f = Math.max(0, 1 - (Date.now() - lastMoveTime) / 200);\r\n    vel = [(pPos[1] - cPos[1]) * factor * f, (cPos[0] - pPos[0]) * factor * f];\r\n    timer = requestAnimationFrame(momentum);\r\n  }\r\n\r\n  function momentum() {\r\n    if(Math.abs(vel[0]) < .001 && Math.abs(vel[1]) < .001) return;\r\n    let decay = .97;\r\n    vel[0] *= decay; vel[1] *= decay;\r\n    rot[0] += vel[0]; rot[1] += vel[1];\r\n    if(timer)\r\n      timer = requestAnimationFrame(momentum);\r\n  }\r\n\r\n  document.addEventListener('mousedown', mouseDown);\r\n  document.addEventListener('mousemove', mouseMove);\r\n  document.addEventListener('mouseup', mouseUp);\r\n  document.addEventListener('click', e => {\r\n    if(!moved) return;\r\n    e.preventDefault();\r\n    e.stopPropagation(); \r\n  }, true);\r\n  document.addEventListener('touchstart', mouseDown);\r\n  document.addEventListener('touchmove', mouseMove);\r\n  document.addEventListener('touchend', mouseUp);\r\n})();\r\n"]}